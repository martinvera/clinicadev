<form [formGroup]="form">
    <div class="filtro-content">
        <div class="garante">
            <mat-form-field>
                <mat-label>Garante</mat-label>
                <mat-select formControlName="garanteId" required>
                    <mat-option *ngFor="let garante of garantes" [value]="garante.codigo">
                        {{garante.descripcion}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>
        <div class="estado">
            <mat-form-field>
                <mat-label>Estado</mat-label>
                <mat-select formControlName="estadoGarante">
                    <mat-option *ngFor="let estado of estados" [value]="estado.id">
                        {{estado.value}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>
        <div class="fechaLote">
            <mat-form-field>
                <mat-label>Fecha de lote desde</mat-label>
                <input matInput [matDatepicker]="picker" formControlName="fechaLoteDesde" (dateChange)="openEvent($event)">
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>

        </div>
        <div class="fechaLote">
            <mat-form-field>
                <mat-label>Fecha de lote hasta</mat-label>
                <input matInput [matDatepicker]="picker1" formControlName="fechaLoteHasta">
                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                <mat-datepicker #picker1></mat-datepicker>
            </mat-form-field>
        </div>

        <div class="buttons">
            <button class="search" matTooltip="Buscar" mat-mini-fab color="primary" (click)="searchFilter()"
                [disabled]="form.invalid">
                <mat-icon>search</mat-icon>
            </button>
            <button class="limpiar" matTooltip="Limpiar filtro" mat-mini-fab color="warn" (click)="clearForm()">
                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="22" height="22" viewBox="0 0 226 226"
                    style=" fill:#000000;">
                    <g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt"
                        stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0"
                        font-family="none" font-weight="none" font-size="none" text-anchor="none"
                        style="mix-blend-mode: normal">
                        <path d="M0,226v-226h226v226z" fill="none"></path>
                        <g fill="#ffffff">
                            <path
                                d="M212.41827,0.54327c-1.96935,0.23768 -3.32752,1.05259 -4.07452,2.44471l-34.22596,64.10577l26.62019,11.95192l24.71875,-68.18029c1.08654,-2.98798 -1.66376,-6.92668 -6.2476,-8.96394c-2.27494,-1.01863 -4.82151,-1.59585 -6.79087,-1.35817zM13.03846,34.76923c-7.19832,0 -13.03846,5.84014 -13.03846,13.03846c0,7.19832 5.84014,13.03846 13.03846,13.03846c7.19832,0 13.03846,-5.84014 13.03846,-13.03846c0,-7.19832 -5.84014,-13.03846 -13.03846,-13.03846zM52.15385,43.46154c-4.78756,0 -8.69231,3.90475 -8.69231,8.69231c0,4.78756 3.90475,8.69231 8.69231,8.69231c4.78756,0 8.69231,-3.90475 8.69231,-8.69231c0,-4.78756 -3.90475,-8.69231 -8.69231,-8.69231zM155.64663,74.15625c-10.59375,-0.20372 -20.94982,6.00991 -25.53365,16.29808l82.84856,36.67067c6.11178,-13.71755 -0.16977,-29.77794 -13.85337,-35.85577c-2.92007,-1.29026 -30.21935,-13.378 -33.13942,-14.66827c-3.42938,-1.52794 -6.79087,-2.3768 -10.32212,-2.44471zM47.80769,78.23077c-11.98588,0 -21.73077,9.74489 -21.73077,21.73077c0,11.98588 9.74489,21.73077 21.73077,21.73077c11.98588,0 21.73077,-9.74489 21.73077,-21.73077c0,-11.98588 -9.74489,-21.73077 -21.73077,-21.73077zM123.05048,103.22115c-9.37139,18.0637 -28.14813,28.92909 -46.72115,35.04087c-9.26953,3.05589 -18.30138,4.95734 -25.53365,5.97596c-7.23227,1.01863 -13.27614,1.15445 -14.39663,1.08654c-3.42938,-0.23768 -6.689,1.59586 -8.28486,4.6857c-1.59586,3.05589 -1.22236,6.7569 0.95072,9.4393c51.78035,63.90205 131.19952,66.55048 131.19952,66.55048c2.7503,0.10187 5.36479,-1.12049 7.0625,-3.25962c0,0 23.08894,-28.25 40.47356,-81.21875l-16.56971,-5.43269c-14.90595,45.39693 -31.54357,67.46725 -35.04087,71.98317c-3.97265,-0.30559 -13.44591,-1.35817 -25.80529,-4.61779c3.9387,-4.34615 11.54447,-13.78545 19.55769,-32.05288c-22.71544,20.94982 -36.16136,24.24339 -42.10337,24.44712c-6.82482,-2.78425 -13.64964,-6.11178 -20.91587,-10.32212c3.53125,-3.22566 8.82813,-9.13371 14.9399,-20.3726c-8.18299,8.55649 -18.94651,11.91797 -26.07692,13.3101c-7.16437,-4.95733 -14.29477,-10.66165 -21.1875,-17.38462c7.8774,-1.15444 17.2488,-2.98798 27.16346,-6.2476c21.01773,-6.92668 44.37831,-19.55769 56.77163,-43.46154z">
                            </path>
                        </g>
                    </g>
                </svg>
            </button>
        </div>
    </div>
</form>
<br>

<div class="mat-elevation-z8">
    <table mat-table [dataSource]="dataSource"><caption class="caption-none"></caption>

        <!-- Position Column -->
        <ng-container matColumnDef="position">
            <th scope="col" mat-header-cell *matHeaderCellDef> Lote </th>
            <td mat-cell *matCellDef="let element"> {{element.rowKey}} </td>
        </ng-container>

        <!-- Name Column -->
        <ng-container matColumnDef="name">
            <th scope="col" mat-header-cell *matHeaderCellDef> Fecha Lote </th>
            <td class="" mat-cell *matCellDef="let element"> {{element.timestamp | date:'d/MM/YYYY':'UTC' }} </td>
        </ng-container>

        <!-- Weight Column -->
        <ng-container matColumnDef="weight">
            <th scope="col" mat-header-cell *matHeaderCellDef>Fecha Envío</th>
            <td mat-cell *matCellDef="let element"> {{element.fechaEnvio}} </td>
        </ng-container>

        <!-- Symbol Column -->
        <ng-container matColumnDef="symbol">
            <th scope="col" mat-header-cell *matHeaderCellDef> Fecha Aceptación</th>
            <td mat-cell *matCellDef="let element"> {{element.fechaAceptacion}} </td>
        </ng-container>
        <!-- Symbol Column -->
        <ng-container matColumnDef="fecha Rechazo">
            <th scope="col" mat-header-cell *matHeaderCellDef> Fecha Rechazo</th>
            <td mat-cell *matCellDef="let element"> {{element.fechaRechazo}} </td>
        </ng-container>

        <!-- Symbol Column -->
        <ng-container matColumnDef="garante">
            <th scope="col" mat-header-cell *matHeaderCellDef>Garante</th>
            <td mat-cell *matCellDef="let element"> {{element.garanteDescripcion}} </td>
        </ng-container>

        <!-- Symbol Column -->
        <ng-container matColumnDef="origen">
            <th scope="col" mat-header-cell *matHeaderCellDef>Origen</th>
            <td class="mt-p-10" mat-cell *matCellDef="let element"> {{element.origen}} </td>
        </ng-container>

        <!-- Symbol Column -->
        <ng-container matColumnDef="usuario">
            <th scope="col" mat-header-cell *matHeaderCellDef>Usuario</th>
            <td mat-cell *matCellDef="let element"> {{element.usuario}} </td>
        </ng-container>

        <ng-container matColumnDef="estado">
            <th scope="col" mat-header-cell *matHeaderCellDef> Estado </th>
            <td mat-cell *matCellDef="let row" class="estado">
                <button [ngClass]="[
                  (row.estadoGarante === 'ACEPTADO') ? 'success' :
                  (row.estadoGarante === 'RECHAZADO') ? 'error' :
                  (row.estadoGarante === 'PENDIENTE') ? 'pending':
                  (row.estadoGarante === 'ENVIADO') ? 'progressing':'']">{{[
                    (row.estadoGarante === 'ACEPTADO') ? 'ACEPTADO' :
                    (row.estadoGarante === 'PENDIENTE') ? 'PENDIENTE':
                    (row.estadoGarante === 'RECHAZADO') ? 'RECHAZADO':
                    (row.estadoGarante === 'ENVIADO') ? 'ENVIADO':'']}}
                </button>
            </td>
        </ng-container>
        <!-- Symbol Column -->
        <ng-container matColumnDef="Nro sinistro">
            <th scope="col" mat-header-cell *matHeaderCellDef>Registro Solicitud</th>
            <td mat-cell *matCellDef="let element"> {{element.registroSolicitud}} </td>
        </ng-container>

        <!-- Symbol Column -->
        <ng-container matColumnDef="opciones">
            <th scope="col" mat-header-cell *matHeaderCellDef>Opciones</th>
            <td mat-cell *matCellDef="let element">
                <span matTooltip="Editar estado y fechas" class="txt-cli-dange d-inline"
                    style="cursor: pointer; color: #0032A0;" (click)="openDialog(element)" *appCheckPermissions="permission.EDITAR_FECHA_ENVIO">
                    <mat-icon>drive_file_rename_outline</mat-icon>
                </span>
                <span matTooltip="Ver Historial" class="txt-cli-dange d-inline" style="cursor: pointer;"
                    (click)="openLog(element)" *appCheckPermissions="permission.VER_HISTORIAL">
                    <svg class="log" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="24" height="24"
                        viewBox="0 0 172 172" style=" fill:#000000;">
                        <g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt"
                            stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0"
                            font-family="none" font-weight="none" font-size="none" text-anchor="none"
                            style="mix-blend-mode: normal">
                            <path d="M0,172v-172h172v172z" fill="none"></path>
                            <g fill="#1abc9c">
                                <path
                                    d="M43,14.33333c-7.84216,0 -14.33333,6.49117 -14.33333,14.33333v35.83333c-7.91917,0 -14.33333,6.41417 -14.33333,14.33333v35.83333c0,7.91917 6.41417,14.33333 14.33333,14.33333v14.33333c0,7.84216 6.49117,14.33333 14.33333,14.33333h86c7.84216,0 14.33333,-6.49117 14.33333,-14.33333v-93.16667l-35.83333,-35.83333zM43,28.66667h57.33333v28.66667h28.66667v7.16667h-86zM28.66667,78.83333h7.16667v28.66667h14.33333v7.16667h-21.5zM71.66667,78.84733c13.35867,-0.215 14.33333,12.75599 14.33333,15.25716v5.78093c0,2.451 -0.61767,15.06109 -14.27735,14.76725c-14.62716,-0.30817 -14.38932,-12.32342 -14.38932,-14.76725v-5.78093c0,-2.5155 1.19683,-15.04933 14.33333,-15.25716zM107.75195,78.84733c8.39933,0.00717 11.7399,3.8485 13.10156,7.16667h-13.35351c-6.321,-0.09317 -7.16667,6.12739 -7.16667,7.76856v5.93489c0,1.66267 1.48193,7.86822 8.42643,7.79655c2.02817,-0.0215 5.7349,-1.18742 5.9069,-1.28776l-0.15397,-5.89291h-7.0127l0.15397,-7.16667h14.17936v17.06282c-0.43,0.40133 -5.07814,4.15801 -13.56348,4.42318c-2.30767,0.07167 -14.15719,0.28677 -15.10319,-14.93523v-5.8929c0,-2.54417 -0.29988,-14.99155 14.58528,-14.97722zM71.68066,84.72624c-6.7725,0.13617 -7.18066,7.6596 -7.18066,9.32226v5.83691c0,1.591 1.10882,9.02417 7.25065,8.90235c5.891,-0.11467 7.08268,-7.31851 7.08268,-8.90235v-5.83691c0,-1.66267 -0.803,-9.45126 -7.15267,-9.32226zM43,129h86v14.33333h-86z">
                                </path>
                            </g>
                        </g>
                    </svg>
                </span>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" colspan="12"><strong>NOTA:</strong> {{messaje}}</td>
          </tr>
    </table>


   
    <div class="pagina" *ngIf="pagination.length > 0">
        <div class="mt-0">
            <label class="pag" for="Items">Items por página:&nbsp;&nbsp;</label>
            <select class="items" name="paginas" id="paginas" (change)="setPage($event)" [(ngModel)]="pageSize">
                <option *ngFor="let item of pageSizeOptions" value="{{ item.code }}">{{ item.name }}</option>
            </select>
            <button mat-icon-button matTooltip="Anterior" (click)="goBack()" [disabled]="page>1? false: true">
                <mat-icon class="arrow">chevron_left</mat-icon>
            </button>
            <button mat-icon-button matTooltip="Siguiente" (click)="goForward()" [disabled]="siguiente">
                <mat-icon class="arrow">chevron_right</mat-icon>
            </button>
        </div>
    </div>
</div>