<div class="container-fluid contenido py-3 px-5">

  <nav aria-label="breadcrumb">
    <ol class="breadcrumb" style="justify-content: flex-end; ">
      <li class="breadcrumb-item">
        <a matTooltip="Volver a menú principal" href="/business-flow/home">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
            class="bi bi-house-door-fill" viewBox="0 0 16 16">
            <path
              d="M6.5 14.5v-3.505c0-.245.25-.495.5-.495h2c.25 0 .5.25.5.5v3.5a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4a.5.5 0 0 0 .5-.5z" />
          </svg></a>
      </li>

      <li class="breadcrumb-item active" aria-current="page">Cargar Documentos</li>
    </ol>
  </nav>


  <form [formGroup]="uploadForm" enctype="multipart/form-data">
    <div class="row">
      <h1 class="mb-3" class="tit">Cargar Documentos</h1>
    </div>

    <div class="row align-items-center text-end">
      <div class="cbotones">
        <button mat-raised-button [disabled]="uploadForm.invalid" (click)="submitButton()"
          class="m-2 btn  align-items-center justify-content-center-flex" style="font-size: small;">
          <span class="m-1">GUARDAR</span>
          <mat-icon>add</mat-icon>
        </button>

        <button mat-raised-button class="m-2 limpiarbtn  align-items-center justify-content-center-flex"
          style="font-size: small;" (click)="formReset()">
          <span class="m-1">LIMPIAR TODO
            <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="22" height="22" viewBox="0 0 226 226"
              style=" fill:#000000;">
              <g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt"
                stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0"
                font-family="none" font-weight="none" font-size="none" text-anchor="none"
                style="mix-blend-mode: normal">
                <path d="M0,226v-226h226v226z" fill="none"></path>
                <g fill="#ffffff">
                  <path
                    d="M212.41827,0.54327c-1.96935,0.23768 -3.32752,1.05259 -4.07452,2.44471l-34.22596,64.10577l26.62019,11.95192l24.71875,-68.18029c1.08654,-2.98798 -1.66376,-6.92668 -6.2476,-8.96394c-2.27494,-1.01863 -4.82151,-1.59585 -6.79087,-1.35817zM13.03846,34.76923c-7.19832,0 -13.03846,5.84014 -13.03846,13.03846c0,7.19832 5.84014,13.03846 13.03846,13.03846c7.19832,0 13.03846,-5.84014 13.03846,-13.03846c0,-7.19832 -5.84014,-13.03846 -13.03846,-13.03846zM52.15385,43.46154c-4.78756,0 -8.69231,3.90475 -8.69231,8.69231c0,4.78756 3.90475,8.69231 8.69231,8.69231c4.78756,0 8.69231,-3.90475 8.69231,-8.69231c0,-4.78756 -3.90475,-8.69231 -8.69231,-8.69231zM155.64663,74.15625c-10.59375,-0.20372 -20.94982,6.00991 -25.53365,16.29808l82.84856,36.67067c6.11178,-13.71755 -0.16977,-29.77794 -13.85337,-35.85577c-2.92007,-1.29026 -30.21935,-13.378 -33.13942,-14.66827c-3.42938,-1.52794 -6.79087,-2.3768 -10.32212,-2.44471zM47.80769,78.23077c-11.98588,0 -21.73077,9.74489 -21.73077,21.73077c0,11.98588 9.74489,21.73077 21.73077,21.73077c11.98588,0 21.73077,-9.74489 21.73077,-21.73077c0,-11.98588 -9.74489,-21.73077 -21.73077,-21.73077zM123.05048,103.22115c-9.37139,18.0637 -28.14813,28.92909 -46.72115,35.04087c-9.26953,3.05589 -18.30138,4.95734 -25.53365,5.97596c-7.23227,1.01863 -13.27614,1.15445 -14.39663,1.08654c-3.42938,-0.23768 -6.689,1.59586 -8.28486,4.6857c-1.59586,3.05589 -1.22236,6.7569 0.95072,9.4393c51.78035,63.90205 131.19952,66.55048 131.19952,66.55048c2.7503,0.10187 5.36479,-1.12049 7.0625,-3.25962c0,0 23.08894,-28.25 40.47356,-81.21875l-16.56971,-5.43269c-14.90595,45.39693 -31.54357,67.46725 -35.04087,71.98317c-3.97265,-0.30559 -13.44591,-1.35817 -25.80529,-4.61779c3.9387,-4.34615 11.54447,-13.78545 19.55769,-32.05288c-22.71544,20.94982 -36.16136,24.24339 -42.10337,24.44712c-6.82482,-2.78425 -13.64964,-6.11178 -20.91587,-10.32212c3.53125,-3.22566 8.82813,-9.13371 14.9399,-20.3726c-8.18299,8.55649 -18.94651,11.91797 -26.07692,13.3101c-7.16437,-4.95733 -14.29477,-10.66165 -21.1875,-17.38462c7.8774,-1.15444 17.2488,-2.98798 27.16346,-6.2476c21.01773,-6.92668 44.37831,-19.55769 56.77163,-43.46154z">
                  </path>
                </g>
              </g>
            </svg>
          </span>

        </button>
      </div>
    </div>

    <div class="form__content">
      <div class="row">
        <div class="col-lg-6">
          <div class="content_col-1">
            <div class="row">
              <div class="col-lg-12 col-md-12">
                <mat-form-field class="example-full-width">
                  <mat-label class="ptext"> N° Encuentro</mat-label>
                  <input matInput (keyup)="obtenerencuentro($event)" placeholder="" required
                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                    formControlName="nroEncuentro">

                  <mat-error *ngIf="nroEncuentro.hasError('required')">
                    El campo es obligatorio
                  </mat-error>
                </mat-form-field>
              </div>
              <div class="col-lg-6 col-md-12">
                <mat-form-field class="example-full-width">
                  <mat-label class="ptext">Fecha de Atención</mat-label>
                  <input matInput [matDatepicker]="picker" class="form-control" formControlName="fechaAtencion">
                  <mat-datepicker-toggle matTooltip="Seleccione fecha de atención" matSuffix [for]="picker">
                  </mat-datepicker-toggle>
                  <mat-datepicker #picker></mat-datepicker>
                </mat-form-field>
              </div>
              <div class="col-lg-6 col-md-12">
                <mat-form-field class="example-full-width">
                  <mat-label class="ptext">Historia Clínica</mat-label>
                  <input matInput placeholder="" required
                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                    formControlName="nroHcPaciente">

                  <mat-error *ngIf="nroHcPaciente.hasError('required')">
                    El campo es obligatorio
                  </mat-error>
                </mat-form-field>


                <input [(ngModel)]="descripService" formControlName="descriptionService" matInput
                  style="display: none;">
              </div>
              <div class="col-lg-6 col-md-12">
                <mat-form-field class="example-full-width pb-0">
                  <mat-label class="ptext">Elegir Sede</mat-label>
                  <mat-select disableRipple formControlName="codigoSede" (selectionChange)="selectFunctionSede($event)">
                    <mat-option *ngFor="let sede of loadedSedes" [value]="sede.codigo">{{sede.descripcion}}</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div class="col-lg-6 col-md-6 col-sm-12">
                <mat-form-field class="example-full-width pb-0">
                  <mat-label class="ptext">Elegir origen de servicio</mat-label>
                  <mat-select disableRipple formControlName="servicio" required
                    (selectionChange)="selectFunctionService($event)">
                    <mat-option *ngFor="let service of loadedServices" [value]="service.codigo">{{service.descripcion}}
                    </mat-option>
                  </mat-select>

                </mat-form-field>
              </div>

              <div class="col-lg-6 col-md-6 col-sm-12">
                <mat-form-field class="example-full-width pb-0">
                  <mat-label class="ptext">Elegir Beneficio</mat-label>
                  <mat-select disableRipple formControlName="beneficio" (selectionChange)="setBeneficio($event)">
                    <mat-option *ngFor="let benefit of loadedBenefits" [value]="benefit.codigo">{{benefit.descripcion}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
              <div class="col-lg-6 col-md-6 col-sm-12">
                <mat-form-field class="example-full-width">
                  <mat-label>Garante</mat-label>
                  <mat-select formControlName="garanteId" (selectionChange)="setGarante($event)" required>
                    <mat-option *ngFor="let garante of garantes" [value]="garante.codigo">
                      {{garante.descripcion}}
                    </mat-option>
                  </mat-select>

                </mat-form-field>
              </div>

              <div class="col-lg-6 col-md-6 col-sm-12">
                <mat-form-field class="example-full-width">
                  <mat-label class="ptext">Tipo de Documento</mat-label>
                  <mat-select disableRipple formControlName="tipoDocumento"
                    (selectionChange)="selectFunctionTipoDocumentUser($event)">
                    <mat-option *ngFor="let document of loadedDocuments" [value]="document.codigo">
                      {{document.descripcion}}</mat-option>
                  </mat-select>

                </mat-form-field>
                <input [(ngModel)]="descriptionDocumentUser" formControlName="tipoDocumentoDescUser" matInput
                  style="display: none;">
              </div>

              <div class="col-lg-6 col-md-12 col-sm-12">
                <mat-form-field class="example-full-width">
                  <mat-label class="ptext">N° Documento</mat-label>
                  <input matInput placeholder=""
                    oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*?)\..*/g, '$1');"
                    formControlName="pacienteID">

                </mat-form-field>
              </div>

              <div class="col-lg-12">
                <mat-form-field class="example-full-width">
                  <mat-label class="ptext">Nombres</mat-label>
                  <input matInput placeholder="" formControlName="nombrePaciente" required
                    onkeyup="javascript:this.value=this.value.toUpperCase();"
                    oninput="this.value = this.value.replace(/[^a-zA-ZÀ-ÿ\u00f1\u00d1\s]/g, '');">

                  <mat-error *ngIf="nombrePaciente.hasError('required')">
                    El campo es obligatorio
                  </mat-error>
                </mat-form-field>
              </div>
              <div class="col-lg-12 col-md-12 col-sm-12">
                <mat-checkbox class="check-section" (click)="dissabletMaterno()">Click si no posee apellido paterno
                </mat-checkbox>
              </div>
              <div class="col-lg-12 col-md-12 col-sm-12">
                <mat-form-field class="example-full-width">
                  <mat-label class="ptext">Apellido Paterno</mat-label>
                  <input matInput placeholder="" formControlName="apellidoPaterno"
                    onkeyup="javascript:this.value=this.value.toUpperCase();"
                    oninput="this.value = this.value.replace(/[^a-zA-ZÀ-ÿ\u00f1\u00d1\s]/g, '');">

                  <mat-error *ngIf="apellidoPaterno.hasError('required')">
                    El campo es obligatorio
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="col-lg-12 col-md-12 col-sm-12">
                <mat-form-field class="example-full-width">
                  <mat-label class="ptext">Apellido Materno</mat-label>
                  <input matInput placeholder="" formControlName="apellidoMaterno"
                    onkeyup="javascript:this.value=this.value.toUpperCase();"
                    oninput="this.value = this.value.replace(/[^a-zA-ZÀ-ÿ\u00f1\u00d1\s]/g, '');">
                </mat-form-field>
              </div>



            </div>
          </div>
        </div>
        <!-- Agregar campo para cargar documento -->
        <div class="col-lg-6">
          <div class="content_col-2">
            <div class="content__header">
              <div class="row row-border-bottom align-items-center header__body">
                <div class="cabecera col-lg-4 ">
                  <strong>Tipo de documento</strong>
                </div>
                <div class="cabecera col-lg-4">
                  <strong>Nombre del Archivo</strong>
                </div>
                <div class="cabecera col-lg-4">
                  <strong>Opción</strong>
                </div>
              </div>
            </div>

            <div class="content__overflow">
              <div class="content__foot">
                <div class="row p-3">
                  <div class="col-lg-12 col-md-12 col-sm-12">
                    <button type="button" (click)="onAddDocument()"
                      class="btn1 mat-raised-button align-items-center button__add-file d-flex justify-content-center">
                      <span>AGREGAR CAMPO &nbsp;</span>
                      <mat-icon>add_circle</mat-icon>
                    </button>
                  </div>
                </div>
              </div>

              <div class="content__body" formArrayName="archivos"
                *ngFor="let archivo of docFromGroupArchivos.controls; let i = index">

                <div class="row pt-3 row-border-bottom align-items-center">
                  <ng-container [formGroup]="$any(archivo)">
                    <input type="text" formControlName="nroEncuentro" matInput [(ngModel)]="nrEncuentro" required
                      style="display: none;" />

                    <!-- Seleccionar documento -->
                    <div class="col-lg-4">
                      <mat-form-field class="example-full-width pb-0">
                        <mat-label>Elegir Documento</mat-label>
                        <mat-select disableRipple formControlName="tipoDocumentoId"
                          (selectionChange)="onSelectOption($event,i)">
                          <mat-option *ngFor="let file of loadedFiles" [value]="file.codigo">{{file.descripcion}}
                          </mat-option>

                        </mat-select>


                      </mat-form-field>
                      <mat-form-field id="nameOtros-{{i}}" style="display: none;">
                        <mat-label class="ptext">Especificar Otros</mat-label>
                        <input [(ngModel)]="loadedDocumentsDesc[i]" matInput placeholder=""
                          formControlName="tipoDocumentoDesc" onkeyup="javascript:this.value=this.value.toUpperCase();"
                          oninput="this.value = this.value.replace(/[^a-zA-ZÀ-ÿ\u00f1\u00d1\s]/g, '');">
                      </mat-form-field>

                    </div>



                    <!-- Nombre del documento -->
                    <div class=col-lg-4>
                      <p>
                        <strong>{{nameFile[i]}}</strong>
                      </p>
                    </div>

                    <div class="col-lg-3">
                      <div class="row">
                        <div class=col-lg-3 style="margin-left: 65px;">
                          <a matTooltip="Cargar documento" class="icon-add-file cursor-pointer" (click)="triggerFile(i)"
                            *appCheckPermissions="permission.CARGAR_DOCUMENTO">
                            <mat-icon class="icon">upload_file</mat-icon>
                          </a>
                          <div class="form-group">

                            <input type="file" alife-file-to-base64 (onFileChanged)="onFileSelected($event,i)"
                              id="input-file-{{i}}" class="form-control" accept="application/pdf" multiple=false
                              style="display: none;" />


                            <input [(ngModel)]="base64[i]" formControlName="archivoBytes" matInput
                              style="display: none;" />
                            <input matInput [(ngModel)]="nameFile[i]" id="name-{{i}}" formControlName="nombreArchivo"
                              style="display: none;" />




                          </div>
                        </div>

                        <div class=col-lg-1>
                          <a matTooltip="Borrar campo" class="icon-remove-file cursor-pointer"
                            *appCheckPermissions="permission.ELIMINAR_DOCUMENTO">
                            <mat-icon class="icon" (click)="onRemoveItem(i)">delete</mat-icon>
                          </a>
                        </div>
                      </div>
                    </div>
                  </ng-container>

                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </form>
</div>